#saveRDS(sumExp, "sumExp.Rds")
sumExp <- readRDS(file = "/Users/jg/Desktop/PhD/DTU_project/Github/dtuPaper/Case_study_L5It/sumExp.Rds")
DTU_tx <-  rownames(rowData(sumExp)[[5+3]][rowData(sumExp)[[5+3]]$empirical_FDR <= 0.05 & !is.na(rowData(sumExp)[[5+3]]$estimates),])
## for data import
library(AnnotationHub)
library(ensembldb)
library(openxlsx)
## for analysis
library(qbDTU)
library(edgeR)
library(tidyverse)
library(SummarizedExperiment)
## for visualization
library(ggplot2)
DTU_tx <-  rownames(rowData(sumExp)[[5+3]][rowData(sumExp)[[5+3]]$empirical_FDR <= 0.05 & !is.na(rowData(sumExp)[[5+3]]$estimates),])
DTU_gene <- tx2gene[which(tx2gene$TXNAME %in% DTU_tx), "GENEID"]
## Load the annotation resource.
ah <- AnnotationHub()
## Query for all available EnsDb databases
all <- query(ah, "EnsDb")
ahEdb <- all[["AH75036"]] #for Mus musculus
txs <- transcripts(ahEdb)
tx2gene <- as.data.frame(matrix(data = NA, nrow = length(txs), ncol = 2))
colnames(tx2gene) <- c("TXNAME","GENEID")
tx2gene$TXNAME <- txs$tx_id
tx2gene$GENEID <- txs$gene_id
DTU_tx <-  rownames(rowData(sumExp)[[5+3]][rowData(sumExp)[[5+3]]$empirical_FDR <= 0.05 & !is.na(rowData(sumExp)[[5+3]]$estimates),])
DTU_gene <- tx2gene[which(tx2gene$TXNAME %in% DTU_tx), "GENEID"]
sink(file = "GSEA/Tasic_L5IT_contrast5_DTU_satuRn.txt")
cat(DTU_gene, "\n")
sink()
DTU_tx <-  rownames(rowData(sumExp)[[6+3]][rowData(sumExp)[[6+3]]$empirical_FDR <= 0.05 & !is.na(rowData(sumExp)[[6+3]]$estimates),])
DTU_gene <- tx2gene[which(tx2gene$TXNAME %in% DTU_tx), "GENEID"]
sink(file = "GSEA/Tasic_L5IT_contrast6_DTU_satuRn.txt")
cat(DTU_gene, "\n")
sink()
DTU_tx <-  rownames(rowData(sumExp)[[7+3]][rowData(sumExp)[[7+3]]$empirical_FDR <= 0.05 & !is.na(rowData(sumExp)[[7+3]]$estimates),])
DTU_gene <- tx2gene[which(tx2gene$TXNAME %in% DTU_tx), "GENEID"]
sink(file = "GSEA/Tasic_L5IT_contrast7_DTU_satuRn.txt")
cat(DTU_gene, "\n")
sink()
rm(list=ls())
gc()
