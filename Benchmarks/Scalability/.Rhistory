# read quasiBinomial results
load("results/finalOutput_quasiBinomial_1.RData")
# read quasiBinomial results
load("results/finalOutput_quasiBinomial_1.RData")
load("results/finalOutput_quasiBinomial_2.RData")
# read limmaDiffsplice results
load("results/finalOutput_limmaDiffsplice_1.RData")
load("results/finalOutput_limmaDiffsplice_2.RData")
# read edgeRDiffsplice results
load("results/finalOutput_edgeRDiffsplice_1.RData")
load("results/finalOutput_edgeRDiffsplice_2.RData")
# read DRIMSeq results
load("results/finalOutput_DRIMSeq_1.RData")
load("results/finalOutput_DRIMSeq_2.RData")
# read DoubleExpSeq results
load("results/finalOutput_DoubleExpSeq_1.RData")
load("results/finalOutput_DoubleExpSeq_2.RData")
# read DEXSeq results
load("results/finalOutput_DEXSeq_2.RData")
load("results/finalOutput_DEXSeq_3.RData")
load("results/finalOutput_DEXSeq_4.RData")
# read BANDITS results
load("results/finalOutput_BANDITS_5.RData")
load("results/finalOutput_BANDITS_6.RData")
finalOutput_all <- c(finalOutput_quasiBinomial_1,finalOutput_quasiBinomial_2,finalOutput_limmaDiffsplice_1,finalOutput_limmaDiffsplice_2,finalOutput_edgeRDiffsplice_1,finalOutput_edgeRDiffsplice_2,finalOutput_DRIMSeq_1,finalOutput_DRIMSeq_2,finalOutput_DoubleExpSeq_1,finalOutput_DoubleExpSeq_2,finalOutput_DEXSeq_2,finalOutput_DEXSeq_3,finalOutput_DEXSeq_4,finalOutput_BANDITS_5,finalOutput_BANDITS_6)
rm(list=setdiff(ls(), "finalOutput_all"))
full_dataframe <-  as.data.frame(matrix(nrow = length(finalOutput_all), ncol=10))
colnames(full_dataframe) <- c("method", "groupSize", "TXs", "TXs_round", "user", "system", "elapsed", "DTU", "removed", "memory")
full_dataframe$method <- rep(c("satuRn","limmaDiffsplice","edgeRDiffsplice","DRIMSeq","DoubleExpSeq","DEXSeq","BANDITS"),times=c(24,24,24,24,24,16,7)) # add method labels
round_to <- function(x, to = 1000) round(x/to)*to
# get data in dataframe format
for (i in seq_len(nrow(full_dataframe))) {
full_dataframe$groupSize[i] <- finalOutput_all[[i]]$info$size
full_dataframe$TXs[i] <- finalOutput_all[[i]]$info$TXs
full_dataframe$TXs_round[i] <- round_to(full_dataframe$TXs[i])
full_dataframe$user[i] <- unname(finalOutput_all[[i]]$timing[1])
full_dataframe$system[i] <- unname(finalOutput_all[[i]]$timing[2])
full_dataframe$elapsed[i] <- unname(finalOutput_all[[i]]$timing[3])
full_dataframe$DTU[i] <- ifelse(is.null(finalOutput_all[[i]]$result),NA,finalOutput_all[[i]]$result)
full_dataframe$removed[i] <- finalOutput_all[[i]]$removed
full_dataframe$memory[i] <- finalOutput_all[[i]]$memory[4]
}
data_30K <- full_dataframe[which(full_dataframe$TXs_round == 30000),]
data_30K <- full_dataframe[which(full_dataframe$TXs_round == 30000),]
# scalability w.r.t. number of cells
ggplot(data = data_30K[-which(data_30K$method == "quasiBinomial"),], aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
library(ggplot2)
library(tidyverse)
# scalability w.r.t. number of cells
ggplot(data = data_30K[-which(data_30K$method == "quasiBinomial"),], aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
data_30K <- full_dataframe[which(full_dataframe$TXs_round == 30000),]
# scalability w.r.t. number of cells
ggplot(data = data_30K[-which(data_30K$method == "quasiBinomial"),], aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
data_30K$method
# scalability w.r.t. number of cells
ggplot(data = data_30K[-which(data_30K$method == "satuRn"),], aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
View(data_30K)
data_30K <- full_dataframe[which(full_dataframe$TXs_round == 30000),]
# scalability w.r.t. number of cells
ggplot(data = data_30K, aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","black")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
data_30K
ggplot(data = data_30K, aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line()
# read quasiBinomial results
load("results/finalOutput_quasiBinomial_1.RData")
load("results/finalOutput_quasiBinomial_2.RData")
# read limmaDiffsplice results
load("results/finalOutput_limmaDiffsplice_1.RData")
load("results/finalOutput_limmaDiffsplice_2.RData")
# read edgeRDiffsplice results
load("results/finalOutput_edgeRDiffsplice_1.RData")
load("results/finalOutput_edgeRDiffsplice_2.RData")
# read DRIMSeq results
load("results/finalOutput_DRIMSeq_1.RData")
load("results/finalOutput_DRIMSeq_2.RData")
# read DoubleExpSeq results
load("results/finalOutput_DoubleExpSeq_1.RData")
load("results/finalOutput_DoubleExpSeq_2.RData")
# read DEXSeq results
load("results/finalOutput_DEXSeq_2.RData")
load("results/finalOutput_DEXSeq_3.RData")
load("results/finalOutput_DEXSeq_4.RData")
# read BANDITS results
load("results/finalOutput_BANDITS_5.RData")
load("results/finalOutput_BANDITS_6.RData")
finalOutput_all <- c(finalOutput_quasiBinomial_1,finalOutput_quasiBinomial_2,finalOutput_limmaDiffsplice_1,finalOutput_limmaDiffsplice_2,finalOutput_edgeRDiffsplice_1,finalOutput_edgeRDiffsplice_2,finalOutput_DRIMSeq_1,finalOutput_DRIMSeq_2,finalOutput_DoubleExpSeq_1,finalOutput_DoubleExpSeq_2,finalOutput_DEXSeq_2,finalOutput_DEXSeq_3,finalOutput_DEXSeq_4,finalOutput_BANDITS_5,finalOutput_BANDITS_6)
rm(list=setdiff(ls(), "finalOutput_all"))
full_dataframe <-  as.data.frame(matrix(nrow = length(finalOutput_all), ncol=10))
colnames(full_dataframe) <- c("method", "groupSize", "TXs", "TXs_round", "user", "system", "elapsed", "DTU", "removed", "memory")
full_dataframe$method <- rep(c("satuRn","limmaDiffsplice","edgeRDiffsplice","DRIMSeq","DoubleExpSeq","DEXSeq","BANDITS"),times=c(24,24,24,24,24,16,7)) # add method labels
round_to <- function(x, to = 1000) round(x/to)*to
# get data in dataframe format
for (i in seq_len(nrow(full_dataframe))) {
full_dataframe$groupSize[i] <- finalOutput_all[[i]]$info$size
full_dataframe$TXs[i] <- finalOutput_all[[i]]$info$TXs
full_dataframe$TXs_round[i] <- round_to(full_dataframe$TXs[i])
full_dataframe$user[i] <- unname(finalOutput_all[[i]]$timing[1])
full_dataframe$system[i] <- unname(finalOutput_all[[i]]$timing[2])
full_dataframe$elapsed[i] <- unname(finalOutput_all[[i]]$timing[3])
full_dataframe$DTU[i] <- ifelse(is.null(finalOutput_all[[i]]$result),NA,finalOutput_all[[i]]$result)
full_dataframe$removed[i] <- finalOutput_all[[i]]$removed
full_dataframe$memory[i] <- finalOutput_all[[i]]$memory[4]
}
data_30K <- full_dataframe[which(full_dataframe$TXs_round == 30000),]
data_30K
# scalability w.r.t. number of cells
ggplot(data = data_30K[-which(data_30K$method == "satuRn"),], aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
data_16cells <- full_dataframe[which(full_dataframe$groupSize == 16),]
ggplot(data = data_16cells[-which(data_16cells$method == "satuRn"),], aes(x=TXs,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#CC79A7", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of transcripts")
# scalability w.r.t. number of cells
ggplot(data = data_30K, aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","black")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
# scalability w.r.t. number of cells - zoom
ggplot(data = data_30K[-which(data_30K$method %in% c("DEXSeq","DRIMSeq")),], aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#56B4E9", "#F0E442", "#0072B2","black")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
ggplot(data = data_16cells, aes(x=TXs,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#CC79A7", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","black")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of transcripts")
# scalability w.r.t. number of transcripts
ggplot(data = data_16cells[-which(data_16cells$method %in% c("BANDITS", "DEXSeq","DRIMSeq")),], aes(x=TXs,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#CC79A7", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","black")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of transcripts")
# read quasiBinomial results
load("data/finalOutput_quasiBinomial_1.RData")
load("data/finalOutput_quasiBinomial_2.RData")
# read limmaDiffsplice results
load("data/finalOutput_limmaDiffsplice_1.RData")
load("data/finalOutput_limmaDiffsplice_2.RData")
# read edgeRDiffsplice results
load("data/finalOutput_edgeRDiffsplice_1.RData")
load("data/finalOutput_edgeRDiffsplice_2.RData")
# read DRIMSeq results
load("data/finalOutput_DRIMSeq_1.RData")
load("data/finalOutput_DRIMSeq_2.RData")
# read DoubleExpSeq results
load("data/finalOutput_DoubleExpSeq_1.RData")
load("data/finalOutput_DoubleExpSeq_2.RData")
# read DEXSeq results
load("data/finalOutput_DEXSeq_2.RData")
load("data/finalOutput_DEXSeq_3.RData")
load("data/finalOutput_DEXSeq_4.RData")
# read BANDITS results
load("data/finalOutput_BANDITS_5.RData")
load("data/finalOutput_BANDITS_6.RData")
getwd()
data_30K <- full_dataframe[which(full_dataframe$TXs_round == 30000),]
png("/Users/jg/Desktop/PhD/DTU_project/DTU_paper/Results/Scalability/scale_cells_intro.png",
width     = 5,
height    = 5,
units     = "in",
res       = 200,
pointsize = 4)
ggplot(data = data_30K[-which(data_30K$method == "satuRn"),], aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
dev.off()
data_16cells <- full_dataframe[which(full_dataframe$groupSize == 16),]
png("/Users/jg/Desktop/PhD/DTU_project/DTU_paper/Results/Scalability/scale_transcripts_intro.png",
width     = 5,
height    = 5,
units     = "in",
res       = 200,
pointsize = 4)
ggplot(data = data_16cells[-which(data_16cells$method == "satuRn"),], aes(x=TXs,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#CC79A7", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of transcripts")
dev.off()
png("/Users/jg/Desktop/PhD/DTU_project/DTU_paper/Results/Scalability/scale_cells_all.png",
width     = 5,
height    = 5,
units     = "in",
res       = 200,
pointsize = 4)
ggplot(data = data_30K, aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","black")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
dev.off()
# zoom
png("/Users/jg/Desktop/PhD/DTU_project/DTU_paper/Results/Scalability/scale_cells_all_zoom.png",
width     = 5,
height    = 5,
units     = "in",
res       = 200,
pointsize = 4)
ggplot(data = data_30K[-which(data_30K$method %in% c("DEXSeq","DRIMSeq")),], aes(x=groupSize,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#56B4E9", "#F0E442", "#0072B2","black")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of cells per group")
dev.off()
png("/Users/jg/Desktop/PhD/DTU_project/DTU_paper/Results/Scalability/scale_transcripts_all.png",
width     = 5,
height    = 5,
units     = "in",
res       = 200,
pointsize = 4)
ggplot(data = data_16cells, aes(x=TXs,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#CC79A7", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","black")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of transcripts")
dev.off()
# zoom
png("/Users/jg/Desktop/PhD/DTU_project/DTU_paper/Results/Scalability/scale_transcripts_all_zoom.png",
width     = 5,
height    = 5,
units     = "in",
res       = 200,
pointsize = 4)
ggplot(data = data_16cells[-which(data_16cells$method %in% c("BANDITS", "DEXSeq","DRIMSeq")),], aes(x=TXs,y=elapsed/60,color=method)) +
geom_line() +
geom_point() +
scale_color_manual(values=c("#CC79A7", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2","black")) +
theme_bw() +
ylab("elapsed  time (min)") +
xlab("number of transcripts")
dev.off()
rm(list=ls())
gc()
