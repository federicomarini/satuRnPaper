#!/usr/bin/env Rscript

root.dir <- rprojroot::find_rstudio_root_file()
setwd(root.dir)

# 1. Scalability benchmark of satuRn

## 1.1. Source the satuRn method file
source("./Scalability_benchmark/DTU_methods/apply_satuRn.R")

## 1.2. Source the first configuration file (specifies #cells and #transcripts in data)
source("./Scalability_benchmark/Configuration/configFile_1.R")

## 1.3. Perform the scalability analysis on the first configuration file

satuRn_1 <- list()
round = 0
invisible(gc())

for (i in L$groupSizes){
	for (j in L$transcripts_amount){
                round = round + 1
		print(paste("Two groups of", i, "cells each with", j, "transcripts"))
		run_satuRn(L, countData, tx2gene) #function outputs the object result
		satuRn_1[round] <- list(result) # runtimes stored in a list

		print(paste0("Runtime (elapsed) = ", unname(result$timing[3]), " seconds"))
		print("---------------------------------------------------") # print progress
	}
}

save(satuRn_1, file = "./Data/Scalability_runtimes/test.RData") # I save this list as RData


